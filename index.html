<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Video Player</title>
    <!-- ستایلی Plyr -->
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    
    <style>
        /* پڕکردنەوەی تەواوی شاشە */
        html, body { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background: #000; overflow: hidden; 
        }
        #player-container { 
            width: 100%; height: 100%; 
            display: flex; align-items: center; justify-content: center; 
        }
        video { width: 100%; height: 100%; }
        
        /* ستایلی تایبەت بۆ ئەوەی Plyr خۆی بگونجێنێت */
        .plyr { width: 100%; height: 100%; }
        .plyr__video-wrapper { width: 100%; height: 100%; }
        
        /* دوگمەی تایبەتی فوول سکرین بۆ مۆبایل (ئەگەر هی Plyr ئیشی نەکرد) */
        #mobile-fs-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.6);
            color: white;
            border: 1px solid white;
            padding: 5px 10px;
            z-index: 9999;
            border-radius: 4px;
            font-family: sans-serif;
            font-size: 12px;
            display: none; /* سەرەتا دیار نییە */
        }
    </style>
</head>
<body>

<div id="player-container">
    <video id="player" playsinline controls crossorigin></video>
    <!-- دوگمەی یەدەگ -->
    <button id="mobile-fs-btn">Full Screen</button>
</div>

<!-- Plyr JS -->
<script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const videoUrl = urlParams.get('url');
    const videoElement = document.getElementById('player');
    const fsBtn = document.getElementById('mobile-fs-btn');

    if (videoUrl) {
        videoElement.src = videoUrl;

        const player = new Plyr(videoElement, {
            controls: ['play-large', 'play', 'progress', 'current-time', 'mute', 'volume', 'settings', 'fullscreen'],
            autoplay: false,
            // ئەمە زۆر گرنگە بۆ ئایفۆن و ئەندرۆید
            fullscreen: { enabled: true, fallback: true, iosNative: true },
            playsinline: true
        });

        // --- چارەسەری کێشەی فوول سکرین لەناو iframe ---
        
        // پشکنین: ئایا ئێمە لەناو مۆبایلین؟
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
        
        // ئەگەر لە مۆبایل بووین و لەناو iframe بووین
        if (isMobile && window.self !== window.top) {
            
            // هەوڵدان بۆ چاککردنی دوگمەی فوول سکرینی خودی Plyr
            player.on('enterfullscreen', event => {
                // ئەگەر Plyr نەیتوانی بیکات، ئێمە دەستوەردان دەکەین
                if (videoElement.webkitEnterFullscreen) {
                    videoElement.webkitEnterFullscreen();
                } else if (videoElement.requestFullscreen) {
                    videoElement.requestFullscreen();
                }
            });

            // ئەگەر زانیمان دوگمەی Plyr هەر کار ناکات، دوگمە یەدەگەکە نیشان دەدەین
            // تێبینی: ئەم دوگمەیە ڕاستەوخۆ فەرمان بە ڤیدیۆکە دەکات نەک چوارچێوەکە
            fsBtn.style.display = 'block';
            
            fsBtn.addEventListener('click', function() {
                if (videoElement.webkitEnterFullscreen) {
                    videoElement.webkitEnterFullscreen(); // تایبەت بە iOS/Android Webkit
                } else if (videoElement.mozRequestFullScreen) {
                    videoElement.mozRequestFullScreen();
                } else if (videoElement.msRequestFullscreen) {
                    videoElement.msRequestFullscreen();
                } else if (videoElement.requestFullscreen) {
                    videoElement.requestFullscreen();
                }
            });
            
            // شاردنەوەی دوگمەکە کاتێک ڤیدیۆکە دەبێتە فوول سکرین
            videoElement.addEventListener('webkitbeginfullscreen', function() {
                fsBtn.style.display = 'none';
            });
            videoElement.addEventListener('webkitendfullscreen', function() {
                fsBtn.style.display = 'block';
            });
        }

    } else {
        document.body.innerHTML = '<h3 style="color:white;text-align:center;margin-top:20%">No Link</h3>';
    }
</script>

</body>
</html>
